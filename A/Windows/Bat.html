<!DOCTYPE html>
<html><head>
    <title>littleboy97学习笔记</title><meta charset="utf-8">
    
<link rel="stylesheet" href="/css/main.css">
<!-- 引入配置文件 -->
    
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<!-- 字体图片库 -->
    
<link rel="stylesheet" href="/lib/highlight/styles/atom-one-dark.css">
<!-- 代码高亮库 -->
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="main">
        <aside id="aside"><!-- 搜索栏 -->
<div id="search"><input class="search-input" type="text" placeholder="search"><icon id="search-icon" class="fa fa-bars" title="收起目录"></div>
<!-- 侧边目录栏 -->
<div id="tree">
</div><div id="toc"></div> 
<!-- 引入备案<footer id="footer"><a href="https://beian.miit.gov.cn" target="_blank">粤ICP备2024236103号</a></footer>--></aside>		<!-- 引入侧边栏-->
        <nav><div>
    <!-- 显示侧边栏 --><icon id="asideshow" class="fa fa-bars" title="显示侧边栏"></icon><ul id="menu">
    <!-- 内部链接本页面直接跳转 -->
    
    <li class="menu-item"><a href="/index.html" class="menu-item-link">主页</a></li>
    
    <li class="menu-item"><a href="/search/index.html" class="menu-item-link">搜索</a></li>
    
    <li class="menu-item"><a href="/Project/index.html" class="menu-item-link">技能</a></li>
    
    <li class="menu-item"><a href="/工具网站/index.html" class="menu-item-link">网站</a></li>
    
    <!-- 外部链接打开新的窗口跳转 -->
    
    <li class="menu-item"><a href="https://github.com/wodemingzihenchang" class="menu-item-link" target="_blank">github</a></li>
    <li class="menu-item"><a href="https://gitee.com/littleboy97" class="menu-item-link" target="_blank">gitee</a></li></ul>
</div></nav>	<!-- 引入导航 -->
        <div id="content"><div>
    <span id="post-author">作者: littleboy</span>
    <span id="post-date">2022-09-12 11:53:19</span>
</div>

<div id="article"><h1 id="Bat-学习笔记"><a href="#Bat-学习笔记" class="headerlink" title="Bat 学习笔记"></a>Bat 学习笔记</h1><span id="more"></span>

<h3 id="Echo"><a href="#Echo" class="headerlink" title="Echo"></a>Echo</h3><p>#显示当前是 echo off 状态还是 echo on 状态</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">echo off #从下一行开始关闭回显</span><br><span class="line">@echo off #从本行开始关闭回显。一般批处理第一行都是这个</span><br><span class="line">echo on #从下一行开始打开回显</span><br><span class="line">echo #显示当前是 echo off 状态还是 echo on 状态</span><br><span class="line">echo. #输出一个”回车换行”，空白行</span><br><span class="line">#(同 echo, echo; echo+ echo[ echo] echo/ echo\)</span><br></pre></td></tr></table></figure>

<h3 id="：关闭单行回显"><a href="#：关闭单行回显" class="headerlink" title="@：关闭单行回显"></a>@：关闭单行回显</h3><h3 id="Dir：显示文件目录"><a href="#Dir：显示文件目录" class="headerlink" title="Dir：显示文件目录"></a>Dir：显示文件目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dir #显示当前目录中的文件和子目录</span><br><span class="line">dir /a #显示当前目录中的文件和子目录，包括隐藏文件和系统文件</span><br><span class="line">dir c: /a:d #显示 C 盘当前目录中的目录</span><br><span class="line">dir c: /a:-d #显示 C 盘根目录中的文件</span><br><span class="line">dir c:\ /b/p #/b 只显示文件名，/p 分页显示</span><br><span class="line">dir \*.exe /s #显示当前目录和子目录里所有的.exe 文件</span><br></pre></td></tr></table></figure>

<h3 id="cd：访问"><a href="#cd：访问" class="headerlink" title="cd：访问"></a>cd：访问</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd\ #进入根目录</span><br><span class="line">cd #显示当前目录</span><br><span class="line">cd /d d:\sdk #可以同时更改盘符和目录</span><br></pre></td></tr></table></figure>

<h3 id="rd："><a href="#rd：" class="headerlink" title="rd："></a>rd：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rd abc #删除当前目录里的 abc 子目录，要求为空目录</span><br><span class="line">rd /s/q d:\temp #删除 d:\temp 文件夹及其子文件夹和文件，/q 安静模式</span><br></pre></td></tr></table></figure>

<h3 id="del：删除"><a href="#del：删除" class="headerlink" title="del：删除"></a>del：删除</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">del d:\test.txt #删除指定文件，不能是隐藏、系统、只读文件</span><br><span class="line">del /q/a/f d:\temp\*._ #删除 d:\temp 文件夹里面的所有文件，包括隐藏、只读、系统文件，不包括子目录</span><br><span class="line">del /q/a/f/s d:\temp\*._ #删除 d:\temp 及子文件夹里面的所有文件，包括隐藏、只读、系统文件</span><br></pre></td></tr></table></figure>

<h3 id="ren：重命名"><a href="#ren：重命名" class="headerlink" title="ren：重命名"></a>ren：重命名</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ren d:\temp tmp #支持对文件夹的重命名</span><br></pre></td></tr></table></figure>

<h3 id="cls：清屏"><a href="#cls：清屏" class="headerlink" title="cls：清屏"></a>cls：清屏</h3><h3 id="type：显示文件内容"><a href="#type：显示文件内容" class="headerlink" title="type：显示文件内容"></a>type：显示文件内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type c:\boot.ini #显示指定文件的内容，程序文件一般会显示乱码</span><br><span class="line">type \_.txt #显示当前目录里所有.txt 文件的内容</span><br></pre></td></tr></table></figure>

<h3 id="copy：复制文件"><a href="#copy：复制文件" class="headerlink" title="copy：复制文件"></a>copy：复制文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">copy c:\test.txt d:\test.bak #复制 c:\test.txt 文件到 d:\ ，并重命名为 test.bak</span><br><span class="line">copy 1.txt + 2.txt 3.txt #合并 1.txt 和 2.txt 的内容，保存为 3.txt 文件。如果不指定 3.txt ，则保存到 1.txt</span><br><span class="line">copy test.txt + #复制文件到自己，实际上是修改了文件日期</span><br><span class="line">copy con test.txt #从屏幕上等待输入，按 Ctrl+Z 结束输入，</span><br><span class="line">    输入内容存为 test.txt 文件。con 代表屏幕，prn 代表打印机，nul 代表空设备</span><br></pre></td></tr></table></figure>

<h3 id="title：设置-cmd-窗口的标题"><a href="#title：设置-cmd-窗口的标题" class="headerlink" title="title：设置 cmd 窗口的标题"></a>title：设置 cmd 窗口的标题</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title 新标题 #可以看到 cmd 窗口的标题栏变了</span><br></pre></td></tr></table></figure>

<h3 id="ver：显示系统版本"><a href="#ver：显示系统版本" class="headerlink" title="ver：显示系统版本"></a>ver：显示系统版本</h3><h3 id="label-和-vol：设置卷标"><a href="#label-和-vol：设置卷标" class="headerlink" title="label 和 vol：设置卷标"></a>label 和 vol：设置卷标</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vol #显示卷标</span><br><span class="line">label #显示卷标，同时提示输入新卷标</span><br><span class="line">label c:system #设置 C 盘的卷标为 system</span><br></pre></td></tr></table></figure>

<h3 id="pause：暂停命令"><a href="#pause：暂停命令" class="headerlink" title="pause：暂停命令"></a>pause：暂停命令</h3><h3 id="rem-和-注释命令"><a href="#rem-和-注释命令" class="headerlink" title="rem 和 :: 注释命令"></a>rem 和 :: 注释命令</h3><h3 id="date-和-time：日期和时间"><a href="#date-和-time：日期和时间" class="headerlink" title="date 和 time：日期和时间"></a>date 和 time：日期和时间</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">date #显示当前日期，并提示输入新日期，按\&quot;回车\&quot;略过输入</span><br><span class="line">date /t #只显示当前日期，不提示输入新日期</span><br><span class="line">time #显示当前时间，并提示输入新时间，按\&quot;回车\&quot;略过输入</span><br><span class="line">time /t #只显示当前时间，不提示输入新时间</span><br></pre></td></tr></table></figure>

<h3 id="goto-和-跳转命令"><a href="#goto-和-跳转命令" class="headerlink" title="goto 和 : 跳转命令"></a>goto 和 : 跳转命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:label #行首为:表示该行是标签行，标签行不执行操作</span><br><span class="line">goto label #跳转到指定的标签那一行</span><br></pre></td></tr></table></figure>

<h3 id="find-外部命令-：查找命令"><a href="#find-外部命令-：查找命令" class="headerlink" title="find (外部命令)：查找命令"></a>find (外部命令)：查找命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">find \&quot;abc\&quot; c:\test.txt #在 c:\test.txt 文件里查找含 abc 字符串的行。如果找不到，errorlevel 返回码为 1</span><br><span class="line">find /i “abc” c:\test.txt #查找含 abc 的行，忽略大小写</span><br><span class="line">find /c \&quot;abc\&quot; c:\test.txt #显示含 abc 的行的行数</span><br></pre></td></tr></table></figure>

<h3 id="more-外部命令-：逐屏显示"><a href="#more-外部命令-：逐屏显示" class="headerlink" title="more (外部命令)：逐屏显示"></a>more (外部命令)：逐屏显示</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">more c:\test.txt #逐屏显示 c:\test.txt 的文件内容</span><br></pre></td></tr></table></figure>

<h3 id="tree：显示目录结构"><a href="#tree：显示目录结构" class="headerlink" title="tree：显示目录结构"></a>tree：显示目录结构</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tree d:\ #显示 D 盘的文件目录结构</span><br></pre></td></tr></table></figure>

<h3 id=""><a href="#" class="headerlink" title="&amp;,&amp;&amp;"></a>&amp;,&amp;&amp;</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&amp;：顺序执行多条命令，而不管命令是否执行成功</span><br><span class="line"></span><br><span class="line">&amp;&amp;：顺序执行多条命令，当碰到执行出错的命令后将不执行后面的命令</span><br><span class="line"></span><br><span class="line">find \&quot;ok\&quot; c:\test.txt &amp;&amp; echo 成功</span><br><span class="line">如果找到了\&quot;ok\&quot;字样，就显示\&quot;成功\&quot;，找不到就不显示</span><br></pre></td></tr></table></figure>

<h3 id="-1"><a href="#-1" class="headerlink" title="|,||"></a>|,||</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">|：管道命令</span><br><span class="line"></span><br><span class="line">dir \_.\* /s/a | find /c \&quot;.exe\&quot; #管道命令表示先执行 dir 命令，对其输出的结果执行后面的 find 命令</span><br><span class="line">该命令行结果：输出当前文件夹及所有子文件夹里的.exe 文件的个数</span><br><span class="line">type c:\test.txt|more #这个和 more c:\test.txt 的效果是一样的</span><br><span class="line"></span><br><span class="line">||：顺序执行多条命令，当碰到执行正确的命令后将不执行后面的命令</span><br><span class="line"></span><br><span class="line">find \&quot;ok\&quot; c:\test.txt || echo 不成功</span><br><span class="line">如果找不到\&quot;ok\&quot;字样，就显示\&quot;不成功\&quot;，找到了就不显示</span><br></pre></td></tr></table></figure>

<h3 id="和-：输出重定向命令"><a href="#和-：输出重定向命令" class="headerlink" title="&gt; 和 &gt;&gt;：输出重定向命令"></a>&gt; 和 &gt;&gt;：输出重定向命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&gt;        #清除文件中原有的内容后再写入</span><br><span class="line">&gt;&gt;       #追加内容到文件末尾，而不会清除原有的内容。主要将本来显示在屏幕上的内容输出到指定文件中。指</span><br><span class="line">定文件如果不存在，则自动生成该文件</span><br><span class="line">type c:\test.txt &gt;prn      #屏幕上不显示文件内容，转向输出到打印机</span><br><span class="line">echo hello world&gt;con     #在屏幕上显示hello world，实际上所有输出都是默认 &gt;con 的</span><br><span class="line">copy c:\test.txt f: &gt;nul     #拷贝文件，并且不显示\&quot;文件复制成功\&quot;的提示信息，但如果f盘不存在，还是会显示出错信息</span><br><span class="line">copy c:\test.txt f: &gt;nul 2&gt;nul      #不显示”文件复制成功”的提示信息，并且f盘不存在的话，也不显示错误提示信息Echo ^^W ^&gt; ^W&gt;c:\test.txt</span><br><span class="line">生成的文件内容为 ^W &gt; W      #^ 和 &gt; 是控制命令，要把它们输出到文件，必须在前面加个 ^ 符号</span><br></pre></td></tr></table></figure>

<h3 id="-2"><a href="#-2" class="headerlink" title="&lt;："></a>&lt;：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">从文件中获得输入信息，而不是从屏幕上。一般用于 date time label 等需要等待输入的命令</span><br><span class="line">@echo off</span><br><span class="line">echo 2005-05-01&gt;temp.txt</span><br><span class="line">date &lt;temp.txt</span><br><span class="line">del temp.txt</span><br></pre></td></tr></table></figure>

<p>这样就可以不等待输入直接修改当前日期</p>
<h3 id="0-1-2…-：命令行传递给批处理的参数"><a href="#0-1-2…-：命令行传递给批处理的参数" class="headerlink" title="%0,1,2… %_：命令行传递给批处理的参数"></a>%0,1,2… %_：命令行传递给批处理的参数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">%0 #批处理文件本身</span><br><span class="line">%1 #第一个参数</span><br><span class="line">%9 #第九个参数</span><br><span class="line">%\_ #从第一个参数开始的所有参数</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">批参数(%n)的替代已被增强。您可以使用以下语法:</span><br><span class="line">%~1 #删除引号(\&quot;)，扩充 %1</span><br><span class="line">%~f1 #将 %1 扩充到一个完全合格的路径名</span><br><span class="line">%~d1 #仅将 %1 扩充到一个驱动器号</span><br><span class="line">%~p1 #仅将 %1 扩充到一个路径</span><br><span class="line">%~n1 #仅将 %1 扩充到一个文件名</span><br><span class="line">%~x1 #仅将 %1 扩充到一个文件扩展名</span><br><span class="line">%~s1 #扩充的路径指含有短名</span><br><span class="line">%~a1 #将 %1 扩充到文件属性</span><br><span class="line">%~t1 #将 %1 扩充到文件的日期/时间</span><br><span class="line">%~z1 #将 %1 扩充到文件的大小</span><br><span class="line">%~$PATH : 1 - 查找列在 PATH 环境变量的目录，并将 %1。扩充到找到的第一个完全合格的名称。如果环境变量名未被定义，或者没有找到文件，此组合键会扩充到空字符串</span><br></pre></td></tr></table></figure>

<p>可以组合修定符来取得多重结果:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">%~dp1 #只将 %1 扩展到驱动器号和路径</span><br><span class="line">%~nx1 #只将 %1 扩展到文件名和扩展名</span><br><span class="line">%~dp$PATH:1 - 在列在 PATH 环境变量中的目录里查找 %1，并扩展到找到的第一个文件的驱动器号和路径。</span><br><span class="line">%~ftza1 #将 %1 扩展到类似 DIR 的输出行。</span><br><span class="line"></span><br><span class="line">可以参照 call/? 或 for/? 看出每个参数的含意：</span><br><span class="line">echo load \&quot;%%1\&quot; \&quot;%%2\&quot;&gt;c:\test.txt #生成的文件内容为 load \&quot;%1\&quot; \&quot;%2\&quot;。批处理文件里，用这个格式把命令行参数输出到文件</span><br></pre></td></tr></table></figure>

<h3 id="if：判断命令"><a href="#if：判断命令" class="headerlink" title="if：判断命令"></a>if：判断命令</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if \&quot;%1\&quot;==\&quot;/a\&quot; echo 第一个参数是/a</span><br><span class="line">if exist c:\test.bat echo 存在 c:\test.bat 文件</span><br><span class="line">if not exist c:\windows ( echo 不存在 c:\windows 文件夹 )</span><br><span class="line">if exist c:\test.bat ( echo 存在 c:\test.bat ) else ( echo 不存在 c:\test.bat )</span><br><span class="line">if /i \&quot;%1\&quot; equ \&quot;/a\&quot; echo 第一个参数是/a #/i 不区分大小写，equ 和 == 是一样的，其它运算符参见 if/?</span><br></pre></td></tr></table></figure>

<h3 id="setlocal-和-endlocal：设置”命令扩展名”和”延缓环境变量扩充”"><a href="#setlocal-和-endlocal：设置”命令扩展名”和”延缓环境变量扩充”" class="headerlink" title="setlocal 和 endlocal：设置”命令扩展名”和”延缓环境变量扩充”"></a>setlocal 和 endlocal：设置”命令扩展名”和”延缓环境变量扩充”</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SETLOCAL ENABLEEXTENSIONS #启用\&quot;命令扩展名\&quot;</span><br><span class="line">SETLOCAL DISABLEEXTENSIONS #停用\&quot;命令扩展名\&quot;</span><br><span class="line">SETLOCAL ENABLEDELAYEDEXPANSION #启用\&quot;延缓环境变量扩充\&quot;</span><br><span class="line">SETLOCAL DISABLEDELAYEDEXPANSION #停用\&quot;延缓环境变量扩充\&quot;</span><br><span class="line">ENDLOCAL #恢复到使用 SETLOCAL 语句以前的状态</span><br></pre></td></tr></table></figure>

<p>“命令扩展名”默认为启用<br>“延缓环境变量扩充”默认为停用<br>批处理结束系统会自动恢复默认值<br>可以修改注册表以禁用”命令扩展名”，详见 cmd &#x2F;? 。所以用到”命令扩展名”的程序，建议在开头和结尾加上 SETLOCAL ENABLEEXTENSIONS 和 ENDLOCAL 语句，以确保程序能在其它系统上正确运行”延缓环境变量扩充”主要用于 if 和 for 的符合语句，在 set 的说明里有其实用例程</p>
<h3 id="Set：设置变量"><a href="#Set：设置变量" class="headerlink" title="Set：设置变量"></a>Set：设置变量</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">引用变量可在变量名前后加 % ，即 %变量名%</span><br><span class="line">set #显示目前所有可用的变量，包括系统变量和自定义的变量</span><br><span class="line">echo %SystemDrive% #显示系统盘盘符。系统变量可以直接引用</span><br><span class="line">set p #显示所有以 p 开头的变量，要是一个也没有就设 errorlevel=1</span><br><span class="line">set p=aa1bb1aa2bb2 #设置变量 p，并赋值为 = 后面的字符串，即 aa1bb1aa2bb2</span><br><span class="line">echo %p% #显示变量 p 代表的字符串，即 aa1bb1aa2bb2</span><br><span class="line">echo %p:~6% #显示变量 p 中第 6 个字符以后的所有字符，即 aa2bb2</span><br><span class="line">echo %p:~6,3% #显示第 6 个字符以后的 3 个字符，即 aa2</span><br><span class="line">echo %p:~0,3% #显示前 3 个字符，即 aa1</span><br><span class="line">echo %p:~-2% #显示最后面的 2 个字符，即 b2</span><br><span class="line">echo %p:~0,-2% #显示除了最后 2 个字符以外的其它字符，即 aa1bb1aa2b</span><br><span class="line">echo %p:aa=c% #用 c 替换变量 p 中所有的 aa，即显示 c1bb1c2bb2</span><br><span class="line">echo %p:aa=% #将变量 p 中的所有 aa 字符串置换为空，即显示 1bb12bb2</span><br><span class="line">echo %p:*bb=c% #第一个 bb 及其之前的所有字符被替换为 c，即显示 c1aa2bb2</span><br><span class="line">set p=%p:*bb=c% #设置变量 p，赋值为 %p:\*bb=c% ，即 c1aa2bb2</span><br><span class="line">set /a p=39 #设置 p 为数值型变量，值为 39</span><br><span class="line">set /a p=39/10 #支持运算符，有小数时用去尾法，39/10=3.9，去尾得 3，p=3</span><br><span class="line">set /a p=p/10 #用 /a 参数时，在 = 后面的变量可以不加%直接引用</span><br><span class="line">set /a p=”1&amp;0″ #”与”运算，要加引号。其它支持的运算符参见 set/?</span><br><span class="line">set p= #取消 p 变量</span><br><span class="line">set /p p=请输入</span><br></pre></td></tr></table></figure>

<p>屏幕上显示”请输入”，并会将输入的字符串赋值给变量 p<br>注意这条可以用来取代 choice 命令<br>注意变量在 if 和 for 的复合语句里是一次性全部替换的，如</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@<span class="built_in">echo</span> off</span><br><span class="line"><span class="built_in">set</span> p=aaa</span><br><span class="line"><span class="keyword">if</span> <span class="variable">%p%</span>==aaa (</span><br><span class="line">          <span class="built_in">echo</span> <span class="variable">%p%</span></span><br><span class="line">          <span class="built_in">set</span> p=bbb</span><br><span class="line">          <span class="built_in">echo</span> <span class="variable">%p%</span></span><br><span class="line">          )</span><br></pre></td></tr></table></figure>

<p>结果将显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Aaa</span><br><span class="line">aaa</span><br></pre></td></tr></table></figure>

<p>因为在读取 if 语句时已经将所有 %p% 替换为 aaa<br>这里的”替换”，在 &#x2F;? 帮助里就是指”扩充”、“环境变量扩充”<br>可以启用”延缓环境变量扩充”，用 ! 来引用变量，即 !变量名!</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">SETLOCAL ENABLEDELAYEDEXPANSION</span><br><span class="line">set p=aaa</span><br><span class="line">if %p%==aaa (</span><br><span class="line">          echo %p%</span><br><span class="line">          set p=bbb</span><br><span class="line">          echo !p!</span><br><span class="line">          )</span><br><span class="line">ENDLOCAL</span><br></pre></td></tr></table></figure>

<p>结果将显示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">aaa</span><br><span class="line"></span><br><span class="line">bbb</span><br></pre></td></tr></table></figure>

<p>还有几个动态变量，运行 set 看不到</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">%CD%</span> #代表当前目录的字符串</span><br><span class="line"><span class="variable">%DATE%</span> #当前日期</span><br><span class="line"><span class="variable">%TIME%</span> #当前时间</span><br><span class="line"><span class="variable">%RANDOM%</span> #随机整数，介于 <span class="number">0</span>~<span class="number">32767</span></span><br><span class="line"><span class="variable">%ERRORLEVEL%</span> #当前 <span class="keyword">ERRORLEVEL</span> 值</span><br><span class="line"><span class="variable">%CMDEXTVERSION%</span> #当前命令处理器扩展名版本号</span><br><span class="line"><span class="variable">%CMDCMDLINE%</span> #调用命令处理器的原始命令行</span><br><span class="line">可以用 <span class="built_in">echo</span> 命令查看每个变量值，如 <span class="built_in">echo</span> <span class="variable">%time%</span></span><br><span class="line">注意 <span class="variable">%time%</span> 精确到毫秒，在批处理需要延时处理时可以用到</span><br></pre></td></tr></table></figure>

<h3 id="start："><a href="#start：" class="headerlink" title="start："></a>start：</h3><p>批处理中调用外部程序的命令，否则等外部程序完成后才继续执行剩下的指令</p>
<h3 id="call："><a href="#call：" class="headerlink" title="call："></a>call：</h3><p>批处理中调用另外一个批处理的命令，否则剩下的批处理指令将不会被执行<br>有时有的应用程序用<code>start</code>调用出错的，也可以<code>call</code>调用</p>
<h3 id="choice-外部命令"><a href="#choice-外部命令" class="headerlink" title="choice (外部命令)"></a>choice (外部命令)</h3><p>选择命令，让用户输入一个字符，从而选择运行不同的命令，返回码 errorlevel 为 1234……<br>win98 里是 choice.com<br>win2000pro 里没有，可以从 win98 里拷过来<br>win2003 里是 choice.exe<br>choice &#x2F;N &#x2F;C y &#x2F;T 5 &#x2F;D y&gt;nul<br>延时 5 秒<br>assoc 和 ftype：文件关联<br>assoc 设置’文件扩展名’关联，关联到’文件类型’</p>
<p>ftype 设置’文件类型’关联，关联到’执行程序和参数’<br>当你双击一个.txt 文件时，windows 并不是根据.txt 直接判断用 notepad.exe 打开<br>而是先判断.txt 属于 txtfile ‘文件类型’<br>再调用 txtfile 关联的命令行 txtfile&#x3D;%SystemRoot%\system32\NOTEPAD.EXE %1<br>可以在”文件夹选项”→”文件类型”里修改这 2 种关联</p>
<h3 id="assoc-显示所有’文件扩展名’关联"><a href="#assoc-显示所有’文件扩展名’关联" class="headerlink" title="assoc #显示所有’文件扩展名’关联"></a>assoc #显示所有’文件扩展名’关联</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">assoc .txt #显示.txt 代表的&#x27;文件类型&#x27;，结果显示 .txt=txtfile</span><br><span class="line">assoc .doc #显示.doc 代表的&#x27;文件类型&#x27;，结果显示 .doc=Word.Document.8</span><br><span class="line">assoc .exe #显示.exe 代表的&#x27;文件类型&#x27;，结果显示 .exe=exefile</span><br><span class="line">ftype #显示所有&#x27;文件类型&#x27;关联</span><br><span class="line">ftype exefile #显示 exefile 类型关联的命令行，结果显示 exefile=\&quot;%1\&quot; %_</span><br><span class="line">assoc .txt=Word.Document.8 #设置.txt 为 word 类型的文档，可以看到.txt 文件的图标都变了</span><br><span class="line">assoc .txt=txtfile #恢复.txt 的正确关联</span><br><span class="line">ftype exefile=\&quot;%1\&quot; %_ #恢复 exefile 的正确关联</span><br></pre></td></tr></table></figure>

<p>如果该关联已经被破坏，可以运行 command.com ，再输入这条命令</p>
<h3 id="pushd-和-popd：切换当前目录"><a href="#pushd-和-popd：切换当前目录" class="headerlink" title="pushd 和 popd：切换当前目录"></a>pushd 和 popd：切换当前目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@echo off</span><br><span class="line">c: &amp; cd\ &amp; md mp3 #在 C:\ 建立 mp3 文件夹</span><br><span class="line">md d:\mp4 #在 D:\ 建立 mp4 文件夹</span><br><span class="line">cd /d d:\mp4 #更改当前目录为 d:\mp4</span><br><span class="line">pushd c:\mp3 #保存当前目录，并切换当前目录为 c:\mp3</span><br><span class="line">popd #恢复当前目录为刚才保存的 d:\mp4</span><br></pre></td></tr></table></figure>

<h3 id="for：循环命令"><a href="#for：循环命令" class="headerlink" title="for：循环命令"></a>for：循环命令</h3><p>这个比较复杂，请对照 for&#x2F;? 来看</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for %%i in (c: d: e: f:) do echo %%i #依次调用小括号里的每个字符串，执行 do 后面的命令</span><br></pre></td></tr></table></figure>

<p>注意：%%i，在批处理中 for 语句调用参数用 2 个%，默认的字符串分隔符是”空格键”，”Tab 键”，”回车键”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">for %%i in (_.txt) do find \&quot;abc\&quot; %%i #对当前目录里所有的 txt 文件执行 find 命令</span><br><span class="line">for /r . %%i in (_.txt) do find \&quot;abc\&quot; %%i #在当前目录和子目录里所有的.txt 文件中搜索包含 abc 字符串的行</span><br><span class="line">for /r . %%i in (.) do echo %%~pni #显示当前目录名和所有子目录名，包括路径，不包括盘符</span><br><span class="line">for /r d:\mp3 %%i in (\*.mp3) do echo %%i&gt;&gt;d:\mp3.txt #把 d:\mp3 及其子目录里的 mp3 文件的文件名都存到 d:\mp3.txt 里去</span><br><span class="line">for /l %%i in (2,1,8) do echo %%i #生成 2345678 的一串数字，2 是数字序列的开头，8 是结尾，1 表示每次加 1</span><br><span class="line">for /f %%i in (&#x27;set&#x27;) do echo %%i #对 set 命令的输出结果循环调用，每行一个</span><br><span class="line">for /f \&quot;eol=P\&quot; %%i in (&#x27;set&#x27;) do echo %%i #取 set 命令的输出结果，忽略以 P 开头的那几行</span><br><span class="line">for /f %%i in (d:\mp3.txt) do echo %%i #显示 d:\mp3.txt 里的每个文件名，每行一个，不支持带空格的名称</span><br><span class="line">for /f \&quot;delims=\&quot; %%i in (d:\mp3.txt) do echo %%i #显示 d:\mp3.txt 里的每个文件名，每行一个，支持带空格的名称</span><br><span class="line">for /f \&quot;skip=5 tokens=4\&quot; %%a in (&#x27;dir&#x27;) do echo %%a #对 dir 命令的结果，跳过前面 5 行，余下的每行取第 4 列</span><br></pre></td></tr></table></figure>

<p>每列之间的分隔符为默认的”空格”，可以注意到 dir 命令输出的前 5 行是没有文件名的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">for /f \&quot;tokens=1,2,3 delims=- \&quot; %%a in (&#x27;date /t&#x27;) do (</span><br><span class="line">          echo %%a</span><br><span class="line">          echo %%b</span><br><span class="line">          echo %%c</span><br><span class="line">          )</span><br></pre></td></tr></table></figure>

<p>对 date &#x2F;t 的输出结果，每行取 1、2、3 列<br>第一列对应指定的 %%a ，后面的 %%b 和 %%c 是派生出来的，对应其它列<br>分隔符指定为 - 和”空格”，注意 delims&#x3D;- 后面有个”空格”<br>其中 tokens&#x3D;1,2,3 若用 tokens&#x3D;1-3 替换，效果是一样的<br>for &#x2F;f &quot;tokens&#x3D;2* delims&#x3D;- &quot; %%a in (‘date &#x2F;t’) do echo %%b<br>取第 2 列给 %%a ，其后的列都给 %%b</p>
<h3 id="subst-外部命令-映射磁盘。"><a href="#subst-外部命令-映射磁盘。" class="headerlink" title="subst (外部命令):映射磁盘。"></a>subst (外部命令):映射磁盘。</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">subst z: \server\d #这样输入 z:就可以访问\server\d 了</span><br><span class="line">subst z: /d #取消该映射</span><br><span class="line">subst #显示目前所有的映时</span><br><span class="line">xcopy (外部命令):文件拷贝</span><br><span class="line">xcopy d:\mp3 e:\mp3 /s/e/i/y #复制 d:\mp3 文件夹、所有</span><br></pre></td></tr></table></figure>

<h3 id="参考："><a href="#参考：" class="headerlink" title="参考："></a>参考：</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43331089/article/details/124222342">https://blog.csdn.net/qq_43331089/article/details/124222342</a></p>
</div>
 			<!-- 引入正文 -->
    </div>	
    
<script src="/lib/highlight/highlight.pack.js"></script>
<!-- 引入代码高亮的 js -->
    
<script src="/lib/jquery-3.4.1.min.js"></script>
	<!-- 引入 jquery -->
    
<script src="/lib/jquery.pjax.js"></script>
		<!-- 引入 pjax -->
    
<script src="/js/main.js"></script>
					<!-- 引入 js 文件 -->
	
<script src="/js/search.js"></script>
				<!-- 引入 js 文件 -->	
	<script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {search_path = "search.xml";} var path = '/' + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
	</script>

	<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; 
	mermaid.initialize({ theme: 'forest'});
	</script> <!-- 引入 mermaid 流程图 -->
</body></html>