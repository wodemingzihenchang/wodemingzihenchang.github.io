<!DOCTYPE html>
<html><head>
    <title>littleboy97学习笔记</title><meta charset="utf-8">
    
<link rel="stylesheet" href="/css/main.css">
<!-- 引入配置文件 -->
    
<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
<!-- 字体图片库 -->
    
<link rel="stylesheet" href="/lib/highlight/styles/atom-one-dark.css">
<!-- 代码高亮库 -->
<meta name="generator" content="Hexo 6.3.0"></head>
<body>
    <div id="main">
        <aside id="aside"><!-- 搜索栏 -->
<div id="search"><input class="search-input" type="text" placeholder="search"><icon id="search-icon" class="fa fa-bars" title="收起目录"></div>
<!-- 侧边目录栏 -->
<div id="tree">
</div><div id="toc"></div> 
<!-- 引入备案<footer id="footer"><a href="https://beian.miit.gov.cn" target="_blank">粤ICP备2024236103号</a></footer>--></aside>		<!-- 引入侧边栏-->
        <nav><div>
    <!-- 显示侧边栏 --><icon id="asideshow" class="fa fa-bars" title="显示侧边栏"></icon><ul id="menu">
    <!-- 内部链接本页面直接跳转 -->
    
    <li class="menu-item"><a href="/index.html" class="menu-item-link">主页</a></li>
    
    <li class="menu-item"><a href="/search/index.html" class="menu-item-link">搜索</a></li>
    
    <li class="menu-item"><a href="/Project/index.html" class="menu-item-link">技能</a></li>
    
    <li class="menu-item"><a href="/工具网站/index.html" class="menu-item-link">网站</a></li>
    
    <!-- 外部链接打开新的窗口跳转 -->
    
    <li class="menu-item"><a href="https://github.com/wodemingzihenchang" class="menu-item-link" target="_blank">github</a></li>
    <li class="menu-item"><a href="https://gitee.com/littleboy97" class="menu-item-link" target="_blank">gitee</a></li></ul>
</div></nav>	<!-- 引入导航 -->
        <div id="content"><div>
    <span id="post-author">作者: littleboy</span>
    <span id="post-date">2025-03-04 16:19:07</span>
</div>

<div id="article"><h1 id="Sw-属性编辑工具"><a href="#Sw-属性编辑工具" class="headerlink" title="Sw 属性编辑工具"></a>Sw 属性编辑工具</h1><p>用于批量处理 SW 文件属性的工具程序，目前只支持 SW 2019 及以下版本的操作。</p>
<img src="Sw_属性编辑工具-B/image1.png">

<span id="more"></span>

<h2 id="选择文件："><a href="#选择文件：" class="headerlink" title="选择文件："></a>选择文件：</h2><p>选择需要处理的 SW 文件，包括后缀为”.sldprt，.sldasm，.slddrw”等文件格式。</p>
<img src="Sw_属性编辑工具-B/image2.png">

<h2 id="获得属性："><a href="#获得属性：" class="headerlink" title="获得属性："></a>获得属性：</h2><p>获得属性可以通过左侧的复选框，选择需要处理的属性名。如果默认不做选择的话，则是输出全部的属性。</p>
<img src="Sw_属性编辑工具-B/image3.png">

<p>默认全部属性</p>
<img src="Sw_属性编辑工具-B/image4.png">

<p>选择部分属性</p>
<img src="Sw_属性编辑工具-B/image5.png">

<h2 id="修改属性："><a href="#修改属性：" class="headerlink" title="修改属性："></a>修改属性：</h2><p>根据表格所显示的内容，对处理文件的属性名和属性值进行修改。批量修改小技巧：你可以全选表格粘贴到 Excel 进行刷格式的修改。</p>
<p>注意：默认空值是不输入的，需要输入空值，你可以在属性值一栏填&lt;空格&gt;表示</p>
<h2 id="删除属性："><a href="#删除属性：" class="headerlink" title="删除属性："></a>删除属性：</h2><p>同获得属性操作类似，你可以通过左侧的复选框，选择需要删除的属性名。如果默认不做选择的话，则是删除全部的属性。</p>
<h2 id="保存-Excel："><a href="#保存-Excel：" class="headerlink" title="保存 Excel："></a>保存 Excel：</h2><p>顾名思义，会将【获得属性】的工具表格数据保存到外部</p>
<h2 id="打开-Excel："><a href="#打开-Excel：" class="headerlink" title="打开 Excel："></a>打开 Excel：</h2><p>使用外部出来的表格打开的话，就“不用”选择文件了，因为表格内就包含文件路径和配置。我们只需要表格数据导入到工具内使用即可</p>
<p>Excel 目前只支持 2007 以下，格式为”.xls”的 Excel。高版本的电脑需要安装数据引擎插件，并不是大家所有电脑都会安装。所有就按通用的低版本来</p>
<img src="Sw_属性编辑工具-B/表格内容格式要求.png">

<h1 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h1><h2 id="2023-04-26"><a href="#2023-04-26" class="headerlink" title="2023&#x2F;04&#x2F;26"></a>2023&#x2F;04&#x2F;26</h2><p>更新”获得评估的值”功能，该功能可以得到属性值的结果（原先的获得属性是获得属性的表达式，方便编辑，不便查看）</p>
<h2 id="2023-07-01"><a href="#2023-07-01" class="headerlink" title="2023&#x2F;07&#x2F;01"></a>2023&#x2F;07&#x2F;01</h2><p>更新”配置特定”的属性操作。原先操作对象只限于自定义的操作，现在增加到配置特定属性操作。</p>
<img src="Sw_属性编辑工具-B/更新配置特定的属性.png">

<h2 id="2024-01-18"><a href="#2024-01-18" class="headerlink" title="2024&#x2F;01&#x2F;18"></a>2024&#x2F;01&#x2F;18</h2><p>修复【选择文件】不能获得空属性的文件的问题。原先代码是会跳过没有属性的文件导致获取不到操作对象。</p>
<h2 id="2024-08-30"><a href="#2024-08-30" class="headerlink" title="2024&#x2F;08&#x2F;30"></a>2024&#x2F;08&#x2F;30</h2><p>增加错误文件的日志记录功能，起因是部分只读和加密文件在导入程序时，会被阻止并且程序退出。</p>
<p>现在改成将错误文件路径填到log日志文本里（并且不会程序退出，而是忽略错误文件继续）</p>
<h2 id="2024-11-02"><a href="#2024-11-02" class="headerlink" title="2024&#x2F;11&#x2F;02"></a>2024&#x2F;11&#x2F;02</h2><p>增加数字进度显示，可用知道：进行操作的当前文件数 &#x2F; 总文件数的值</p>
<img src="Sw_属性编辑工具-B/增加数字进度显示.png">

<h1 id="Q-A"><a href="#Q-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h1><h2 id="没有在表格是数据是否修改"><a href="#没有在表格是数据是否修改" class="headerlink" title="没有在表格是数据是否修改"></a>没有在表格是数据是否修改</h2><p>A没有显示的数据是不做处理（保留原样），需要删除，则先进行选择“勾选”该属性【删除属性】操作</p>
<h2 id="datagridview-不能批量编辑"><a href="#datagridview-不能批量编辑" class="headerlink" title="datagridview 不能批量编辑"></a>datagridview 不能批量编辑</h2><p>A1：只能是通过【打开 Excel】功能，导入已批量编辑好的表格文件；</p>
<h2 id="不同属性的文件会覆盖属性名列表头"><a href="#不同属性的文件会覆盖属性名列表头" class="headerlink" title="不同属性的文件会覆盖属性名列表头"></a>不同属性的文件会覆盖属性名列表头</h2><p>A2：在填入属性名列表头前，做不同文件的属性名整理包括：合并不同文件属性名，再排除重复属性名，再重新排列属性名数组。</p>
<h2 id="打开文件操作属性"><a href="#打开文件操作属性" class="headerlink" title="打开文件操作属性"></a>打开文件操作属性</h2><p>模板格式的文件（.prtdot.asmdot.drwdot）属性在 SWDocumentManage.dll 是不能操作的，所以需要增加一项打开文件操作属性的程序</p>
<h2 id="评估的值不正确"><a href="#评估的值不正确" class="headerlink" title="评估的值不正确"></a>评估的值不正确</h2><p>钣金参数引用时，有时遇到需要<strong>打开</strong>，<strong>保存后</strong>才能读取到最新结果</p>
<h2 id="类型转换失败"><a href="#类型转换失败" class="headerlink" title="类型转换失败"></a>类型转换失败</h2><img src="Sw_属性编辑工具-B/类型转换失败.png">

<h2 id="未注册Microsoft-ACE-OLEDB-12-0"><a href="#未注册Microsoft-ACE-OLEDB-12-0" class="headerlink" title="未注册Microsoft.ACE.OLEDB.12.0"></a>未注册Microsoft.ACE.OLEDB.12.0</h2><p>是【保存excel】功能的问题，原先支持的excel版本是2003-2007的xls格式，需要在微软下载运行库进行安装注册<a target="_blank" rel="noopener" href="https://www.microsoft.com/zh-cn/download/details.aspx?id=13255">Download</a></p>
<p>还有一种情况生成程序时，使用的目标平台也有选择：按道理现在平台应该大都为x64</p>
<img src="Sw_属性编辑工具-B/未注册Microsoft.png">



<h2 id="未将对象引用设置到对象的实例"><a href="#未将对象引用设置到对象的实例" class="headerlink" title="未将对象引用设置到对象的实例"></a>未将对象引用设置到对象的实例</h2><p>请检查：</p>
<p>1、文件版本，目前只支持到2023；</p>
<p>2、文件只读，只读文件是不能被读写的；</p>
<p>3、文件加密，和2类似读写权限被限制了；</p>
<img src="Sw_属性编辑工具-B/image-20240828142916196.png">

<img src="Sw_属性编辑工具-B/image-20250507151812467.png">

<h2 id="无法创建-ActiveX"><a href="#无法创建-ActiveX" class="headerlink" title="无法创建 ActiveX"></a>无法创建 ActiveX</h2><img src="Sw_属性编辑工具-B/image-20240828143141115.png">

<h2 id="不是有效名称"><a href="#不是有效名称" class="headerlink" title="不是有效名称"></a>不是有效名称</h2><p>已知有属性名或属性值是空格时会出现该情况。</p>
<img src="Sw_属性编辑工具-B/不是有效名称.png">

<h2 id="低版本文件"><a href="#低版本文件" class="headerlink" title="低版本文件"></a>低版本文件</h2><p>目前发现2013版本文件是支持使用该工具的，底层的程序处理不一样，方法不同。识别不了</p>
<p>A目前方式是跳过并作出提示：如下：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123; configs = configmgr.GetConfigurationNames(); &#125;</span><br><span class="line"><span class="keyword">catch</span> (Exception) &#123; Error_file += filepath[j] + <span class="string">&quot;\n&quot;</span>; Error_Switch = <span class="literal">true</span>; Error_Alert = Error_Alert2; <span class="keyword">continue</span>; &#125;</span><br></pre></td></tr></table></figure>



<!-- 许可

littleboy:

-->
</div>
 			<!-- 引入正文 -->
    </div>	
    
<script src="/lib/highlight/highlight.pack.js"></script>
<!-- 引入代码高亮的 js -->
    
<script src="/lib/jquery-3.4.1.min.js"></script>
	<!-- 引入 jquery -->
    
<script src="/lib/jquery.pjax.js"></script>
		<!-- 引入 pjax -->
    
<script src="/js/main.js"></script>
					<!-- 引入 js 文件 -->
	
<script src="/js/search.js"></script>
				<!-- 引入 js 文件 -->	
	<script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {search_path = "search.xml";} var path = '/' + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
	</script>

	<script type="module">import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs'; 
	mermaid.initialize({ theme: 'forest'});
	</script> <!-- 引入 mermaid 流程图 -->
</body></html>